
### 1. Создание основной таблицы с партиционированием
В PostgreSQL 11+ проще использовать встроенное партиционирование:

```sql
CREATE TABLE Продажи (
    id BIGINT PRIMARY KEY,
    дата DATE NOT NULL,
    товар_id INT NOT NULL,
    количество INT,
    цена DECIMAL(10,2)
) PARTITION BY RANGE (EXTRACT(YEAR FROM дата));

-- Создаем партиции
CREATE TABLE Продажи_2019 PARTITION OF Продажи
    FOR VALUES FROM (2019) TO (2020);

CREATE TABLE Продажи_2020 PARTITION OF Продажи
    FOR VALUES FROM (2020) TO (2021);

CREATE TABLE Продажи_2021 PARTITION OF Продажи
    FOR VALUES FROM (2021) TO (2022);
```

---

### 2. Вставка данных
При вставке данных в таблицу `Продажи` — они автоматически попадают в нужную партицию:

```sql
INSERT INTO Продажи (id, дата, товар_id, количество, цена) VALUES
(1, '2019-05-20', 101, 2, 99.99),
(2, '2020-08-15', 102, 1, 149.99),
(3, '2021-01-10', 103, 5, 49.99);
```

---

### 3. Запросы
Запрос к основной таблице автоматически учитывает партиции, что ускоряет выполнение:

```sql
SELECT * FROM Продажи WHERE дата >= '2020-01-01' AND дата < '2021-01-01';
```

Этот запрос будет выполняться только по партиции `Продажи_2020`.

---
